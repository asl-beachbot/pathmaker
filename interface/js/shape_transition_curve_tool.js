// Generated by CoffeeScript 1.7.1
(function() {
  var handle, handle2, hitOptions, node, tool;

  window.shape_transition_curve_tool = new paper.Tool();

  tool = shape_transition_curve_tool;

  tool.minDistance = 0;

  handle = handle2 = node = null;

  hitOptions = {
    segments: true,
    stroke: true,
    handles: true,
    tolerance: 10
  };

  tool.onMouseDown = function(event) {
    var c, hitResult, _i, _len, _ref;
    node = handle = handle2 = null;
    console.log(event);
    _ref = window.all_connections;
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      c = _ref[_i];
      hitResult = c.hitTest(event.point, hitOptions);
      if (hitResult) {
        break;
      }
    }
    if (!hitResult) {
      paper.project.deselectAll();
    }
    if (hitResult) {
      console.log(hitResult);
      hitResult.item.fullySelected = true;
      if (hitResult.type === 'handle-in') {
        handle2 = hitResult.segment.handleOut;
        return handle = hitResult.segment.handleIn;
      } else if (hitResult.type === 'handle-out') {
        handle2 = hitResult.segment.handleIn;
        return handle = hitResult.segment.handleOut;
      } else if (hitResult.type === 'segment') {
        return node = hitResult.segment.point;
      }
    }
  };

  tool.onMouseDrag = function(event) {
    if (handle) {
      handle.x += event.delta.x;
      handle.y += event.delta.y;
      handle2.x -= event.delta.x;
      return handle2.y -= event.delta.y;
    } else if (node) {
      node.x += event.delta.x;
      return node.y += event.delta.y;
    }
  };

}).call(this);
